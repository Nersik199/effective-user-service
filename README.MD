# User Service API

## –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ **Effective Mobile**

–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ Node.js —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Express –∏ TypeScript.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–¥–µ—Ä–∂–∏—Ç:

- **fullName** ‚Äî –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **birthDate** ‚Äî –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
- **email** ‚Äî –£–Ω–∏–∫–∞–ª—å–Ω—ã–π email
- **password** ‚Äî –ü–∞—Ä–æ–ª—å
- **role** ‚Äî –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`admin` –∏–ª–∏ `user`)
- **status** ‚Äî –°—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`ACTIVE` –∏–ª–∏ `BLOCKED`)

API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID (–¥–æ—Å—Ç—É–ø–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∏–ª–∏ —Å–∞–º–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–¥–º–∏–Ω –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª—é–±–æ–≥–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–µ–±—è)

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ Schema/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ userSchemas.ts
‚îÇ   ‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sequelize.pg.ts
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers.admin.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ controllers.users.ts
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ checkRole.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ checkToken.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validate.ts
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interfaces/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.interface.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.ts
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.ts
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ app.ts
‚îÇ   ‚îî‚îÄ‚îÄ migration.ts
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.MD
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ yarn.lock
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/Nersik199/effective-user-service.git
cd effective-user-service

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
yarn install

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ dev-—Ä–µ–∂–∏–º–µ
yarn start:dev

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
yarn build

# –ó–∞–ø—É—Å–∫ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
yarn start

```

## –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

```
–í `package.json` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã:

| –°–∫—Ä–∏–ø—Ç        | –û–ø–∏—Å–∞–Ω–∏–µ                                     |
| ------------- | ------------------------------------------- |
| `yarn start:dev` | –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π) |
| `yarn build`     | –°–±–æ—Ä–∫–∞ TypeScript –≤ JavaScript (–ø–∞–ø–∫–∞ `dist`) |
| `yarn start`     | –ó–∞–ø—É—Å–∫ —É–∂–µ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ `dist` |
```

## –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

#### –°–µ—Ä–≤–∏—Å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª—é–±—É—é –°–£–ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, PostgreSQL). –ù–∏–∂–µ –ø—Ä–∏–º–µ—Ä –¥–ª—è PostgreSQL.

```
# –ó–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è –≤ PostgreSQL
psql -U postgres

# –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
CREATE DATABASE user_service;

# –í—ã–π—Ç–∏
\q

```

–ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–µ–∫—Ä–µ—Ç–æ–º JWT.

```
PORT=3000

POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=test
USER_PASSWORD_SECRET=mysecretpassword
JWT_SECRET=mysecretjwtsecret
```

## üöÄ API Endpoints

- üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

| –ú–µ—Ç–æ–¥ | URL                    | –û–ø–∏—Å–∞–Ω–∏–µ                   | –î–æ—Å—Ç—É–ø             |
| ----- | ---------------------- | -------------------------- | ------------------ |
| POST  | `/users/register`      | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è   | –í—Å–µ                |
| POST  | `/users/login`         | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è   | –í—Å–µ                |
| GET   | `/users/profile`       | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è          | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–∞–¥–º–∏–Ω |
| PATCH | `/users/profile/block` | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–≤–æ–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å       |

- üõ† –ê–¥–º–∏–Ω

| –ú–µ—Ç–æ–¥ | URL                    | –û–ø–∏—Å–∞–Ω–∏–µ                            | –î–æ—Å—Ç—É–ø |
| ----- | ---------------------- | ----------------------------------- | ------ |
| GET   | `/admin/users/:userId` | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID        | –ê–¥–º–∏–Ω  |
| GET   | `/admin/users`         | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –ê–¥–º–∏–Ω  |
| PATCH | `/admin/:userId/block` | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è             | –ê–¥–º–∏–Ω  |

## –í–∞–ª–∏–¥–∞—Ü–∏—è

```
–ü—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π –æ—à–∏–±–æ–∫:
{
   "message": "Validation error",
   "fields": {
      "fullName": "Full name is required",
      "email": "Email is required",
      "password": "Password is required",
      "birthDate": "Birth date is required"
   }
}

```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **JWT**

**checkToken** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞

**checkRole** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Node.js
- Express
- TypeScript
- PostgreSQL (–∏–ª–∏ –¥—Ä—É–≥–∞—è –°–£–ë–î)
- Sequelize ORM
- Joi –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
